<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‘æˆ°å¤§å»³ - æ¼”ç®—æ³•ç”Ÿå­˜æŒ‘æˆ°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        :root {
            --squid-pink: #ff1493;
            --squid-cyan: #00d9ff;
            --squid-dark: #0a0a0a;
            --squid-green: #00ff41;
            --island-sand: #4a3f35;
            --island-sand-dark: #3a312a;
        }
        body {
            font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--squid-dark);
            color: #fff;
            overflow-x: hidden;
        }
        .navbar {
            background: linear-gradient(135deg, var(--squid-dark) 0%, #1a0a1a 100%);
            border-bottom: 3px solid var(--squid-pink);
            padding: 1rem 3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(255, 20, 147, 0.3);
        }
        .logo { font-size: 2rem; font-weight: 900; color: var(--squid-pink); text-shadow: 0 0 20px rgba(255, 20, 147, 0.8); letter-spacing: 2px; }
        .player-auth-container { display: flex; align-items: center; gap: 1rem; }
        .auth-button { background: var(--squid-pink); color: #000; border: none; padding: 0.6rem 1.2rem; border-radius: 20px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all 0.2s; }
        .auth-button:hover { background: var(--squid-cyan); box-shadow: 0 0 15px var(--squid-cyan); }
        .player-profile { display: flex; align-items: center; gap: 1rem; }
        .player-avatar { width: 40px; height: 40px; border-radius: 50%; border: 2px solid var(--squid-cyan); }
        .player-name { font-weight: 600; }

        .games-section, .articles-section { padding: 4rem 3rem; }
        .section-title { text-align: center; font-size: 2.5rem; font-weight: 900; margin-bottom: 3rem; color: var(--squid-pink); text-shadow: 0 0 20px rgba(255, 20, 147, 0.6); }

        /* --- ENHANCED OCEAN & ISLANDS STYLE --- */
        .ocean-frame {
            background: linear-gradient(to top, #003366, #001f3f); /* Brighter, more distinct blue */
            border: 3px solid var(--squid-cyan);
            border-radius: 20px;
            padding: 3rem 2rem;
            position: relative;
            box-shadow: inset 0 10px 30px rgba(0,0,0,0.5), 0 0 50px rgba(0, 217, 255, 0.5); /* Added inner shadow for depth */
            min-height: 500px;
        }
        .waves-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            border-radius: 17px;
            z-index: 1;
        }
        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100px;
            background-size: 1000px 100px;
            /* Increased wave opacity */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" preserveAspectRatio="none"><path d="M 0 50 C 250 100 750 0 1000 50 Z" stroke="none" fill="rgba(0, 217, 255, 0.2)"></path></svg>');
            animation: wave-move 15s linear infinite;
        }
        .wave.wave2 { bottom: 10px; opacity: 0.7; animation-duration: 12s; animation-direction: reverse; } /* Increased opacity */
        .wave.wave3 { bottom: 20px; opacity: 0.5; animation-duration: 9s; } /* Increased opacity */
        @keyframes wave-move { from { transform: translateX(0); } to { transform: translateX(-1000px); } }

        .islands-container {
            position: relative;
            width: 100%;
            height: 450px;
            z-index: 2;
        }
        .island {
            width: 130px;
            height: 120px;
            background: linear-gradient(145deg, var(--island-sand), var(--island-sand-dark));
            border: 3px solid #312821;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
            position: absolute;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }
        .island:nth-child(1) { top: 20px; left: 10%; border-radius: 45% 55% 60% 40% / 70% 80% 20% 30%; }
        .island:nth-child(2) { top: 180px; left: 25%; border-radius: 60% 40% 45% 55% / 70% 30% 70% 30%; }
        .island:nth-child(3) { top: 40px; left: 45%; border-radius: 50% 50% 35% 65% / 50% 40% 60% 50%; }
        .island:nth-child(4) { top: 220px; left: 60%; border-radius: 30% 70% 50% 50% / 60% 60% 40% 40%; }
        .island:nth-child(5) { top: 60px; left: 75%; border-radius: 65% 35% 33% 67% / 57% 70% 30% 43%; }
        .island:nth-child(6) { top: 250px; left: 85%; border-radius: 38% 62% 70% 30% / 50% 61% 39% 50%; }

        .island:hover {
            transform: scale(1.15) rotate(-3deg);
            box-shadow: 0 15px 40px rgba(0,0,0,0.6);
            border-color: var(--squid-cyan);
            z-index: 11;
        }
        .island-icon { font-size: 3rem; line-height: 1; text-shadow: 0 0 10px #000; }
        .island-name { font-size: 1rem; font-weight: bold; margin-top: 0.5rem; color: var(--squid-cyan); }
        .island-description {
            position: absolute;
            bottom: 115%;
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            background: var(--squid-dark);
            border: 2px solid var(--squid-cyan);
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.95rem;
            line-height: 1.6;
            text-align: left;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            pointer-events: none;
            z-index: 10;
        }
        .island-description::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -8px; border-width: 8px; border-style: solid; border-color: var(--squid-cyan) transparent transparent transparent; }
        .island:hover .island-description { opacity: 1; visibility: visible; }
        .island.disabled { opacity: 0.6; cursor: not-allowed; filter: grayscale(80%); }
        .island.disabled:hover { transform: none; box-shadow: 0 5px 15px rgba(0,0,0,0.4); border-color: #312821; z-index: auto; }
        .island.disabled .island-description { content: 'è«‹å…ˆç™»å…¥ä»¥æŒ‘æˆ°'; display: block; }
        /* --- END NEW STYLE --- */

        .articles-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; max-width: 1400px; margin: 0 auto; }
        .article-card { background: linear-gradient(135deg, #1a0a1a 0%, #0a0a1a 100%); border: 3px solid var(--squid-pink); border-radius: 20px; padding: 2rem; transition: all 0.3s; cursor: pointer; }
        .article-card:hover { transform: translateY(-10px); box-shadow: 0 10px 40px rgba(255, 20, 147, 0.4); border-color: var(--squid-cyan); }
        .article-icon { font-size: 4rem; margin-bottom: 1rem; }
        .article-title { font-size: 1.8rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--squid-cyan); }
        .article-subtitle { font-size: 1.1rem; color: #888; margin-bottom: 1rem; }
        .article-description { color: #aaa; line-height: 1.6; }

        /* Animation Modal Styles (Updated for Story) */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 200; }
        #animation-container { width: 90vw; height: 90vh; max-width: 1000px; max-height: 600px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        #animation-svg { width: 100%; height: 100%; overflow: visible; font-family: 'VT323', monospace; }
        .typing-text { fill: var(--squid-green); font-size: 24px; }
        .cursor { fill: var(--squid-green); animation: blink 1s step-end infinite; }
        .challenger { opacity: 0; animation: slide-in 1s 4s forwards; }
        .challenger-body { fill: var(--squid-green); }
        .challenger-head { fill: #ffdbac; }
        .challenger-arm { fill: none; stroke: #ffdbac; stroke-width: 10; stroke-linecap: round; transform-origin: 160px 250px; }
        .card-group { opacity: 0; animation: card-fall-in 1s 5.5s forwards; transform-origin: center; cursor: pointer; }
        .card-rect { fill: #d2b48c; stroke: #a07c54; stroke-width: 2; }
        .card-symbol { stroke: #a07c54; stroke-width: 8; fill: none; }
        .card-challenge-text {
            font-size: 18px;
            fill: var(--squid-pink);
            font-weight: bold;
            text-anchor: middle;
            opacity: 0;
            animation: fade-in 1s 7s forwards;
        }
        .close-btn { cursor: pointer; opacity: 0.7; transition: opacity 0.2s; }
        .close-btn:hover { opacity: 1; }
        .close-btn-line { stroke: #888; stroke-width: 4; }
        @keyframes blink { 50% { opacity: 0; } }
        @keyframes fade-in { to { opacity: 1; } }
        @keyframes slide-in { from { transform: translateX(-100px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes card-fall-in { from { transform: translateY(-300px) rotate(-15deg); opacity: 0; } to { transform: translateY(0) rotate(0); opacity: 1; } }
        @keyframes arm-slap { 0% { transform: rotate(0deg); } 50% { transform: rotate(20deg); } 100% { transform: rotate(-10deg); } }
        @keyframes card-flip-out { from { transform: rotateY(0) scale(1); opacity: 1; } to { transform: rotateY(360deg) scale(0); opacity: 0; } }
    </style>
</head>
<body>
    <!-- Animation Modal -->
    <div id="animation-modal" class="modal-overlay">
        <div id="animation-container">
            <svg id="animation-svg" viewBox="0 0 800 400">
                <g id="text-scene"><text id="line1" class="typing-text" x="50" y="180"></text><text id="line2" class="typing-text" x="50" y="230"></text><rect id="cursor" class="cursor" x="50" y="160" width="12" height="24" style="display: none;"></rect></g>
                <g id="character-scene" style="opacity: 0;"><g class="challenger"><rect class="challenger-body" x="120" y="230" width="60" height="100" rx="10" /><circle class="challenger-head" cx="150" cy="200" r="30" /><path id="challenger-arm" class="challenger-arm" d="M 160 250 C 200 230, 250 250, 280 280" /></g><g id="card-group" class="card-group"><rect class="card-rect" x="350" y="150" width="220" height="120" rx="5"></rect><circle class="card-symbol" cx="385" cy="180" r="10"></circle><polygon class="card-symbol" points="425,170 440,190 410,190"></polygon><rect class="card-symbol" x="455" y="170" width="20" height="20"></rect><text id="card-text" class="card-challenge-text" x="460" y="240">ä½ ï¼Œæ•¢æ¥å—æŒ‘æˆ°å—ï¼Ÿ</text></g></g>
                <g id="close-btn" class="close-btn"><line class="close-btn-line" x1="760" y1="20" x2="780" y2="40" /><line class="close-btn-line" x1="780" y1="20" x2="760" y2="40" /></g>
            </svg>
        </div>
    </div>

    <!-- Main Content -->
    <nav class="navbar"><div class="logo">ğŸ¦‘ æ¼”ç®—æ³•ç”Ÿå­˜æŒ‘æˆ°</div><div id="player-auth-container" class="player-auth-container"></div></nav>

    <section class="games-section">
        <h2 class="section-title">æŒ‘æˆ°å¤§å»³</h2>
        <div class="ocean-frame">
            <div class="waves-wrapper"><div class="wave"></div><div class="wave wave2"></div><div class="wave wave3"></div></div>
            <div class="islands-container">
                <a class="island" data-game="queue-game.html"><div class="island-icon">ğŸ”¨</div><div class="island-name">æ‰“åœ°é¼ æŒ‘æˆ°</div><div class="island-description"><strong>Queue (ä½‡åˆ—):</strong> å­¸ç¿’å…ˆé€²å…ˆå‡º (FIFO) çš„æ¦‚å¿µã€‚åœ°é¼ ä¾åºæ’éšŠå‡ºç¾ï¼Œä½ å¿…é ˆæŒ‰ç…§ç‰ å€‘å‡ºç¾çš„é †åºé€²è¡Œæ‰“æ“Šã€‚</div></a>
                <a class="island" data-game="stack-game.html"><div class="island-icon">ğŸ“š</div><div class="island-name">å †ç–Šæ¶ˆæ¶ˆæ¨‚</div><div class="island-description"><strong>Stack (å †ç–Š):</strong> å­¸ç¿’å¾Œé€²å…ˆå‡º (LIFO) çš„æ¦‚å¿µã€‚æ–¹å¡Šæœƒä¸æ–·å †ç–Šèµ·ä¾†ï¼Œä½†ä½ æ°¸é åªèƒ½å¾æœ€é ‚ç«¯çš„é‚£ä¸€å€‹é–‹å§‹æ¶ˆé™¤ã€‚</div></a>
                <a class="island" data-game="linked-list-game.html"><div class="island-icon">ğŸª</div><div class="island-name">æ¤ªç³–æŒ‘æˆ°</div><div class="island-description"><strong>Linked List (éˆçµä¸²åˆ—):</strong> å­¸ç¿’ç¯€é»ä¹‹é–“å¦‚ä½•é€éæŒ‡æ¨™é€£çµã€‚æ¯å€‹æ¤ªç³–åœ–æ¡ˆéƒ½æ˜¯ä¸€å€‹ç¯€é»ï¼Œä½ éœ€è¦ä¾å¾ªæŒ‡æ¨™å°å¿ƒç¿¼ç¿¼åœ°å°‡å®ƒå®Œæ•´å–å‡ºã€‚</div></a>
                <a class="island" data-game="tree-game.html"><div class="island-icon">ğŸŒ‰</div><div class="island-name">ç»ç’ƒæ©‹æŒ‘æˆ°</div><div class="island-description"><strong>Binary Tree (äºŒå…ƒæ¨¹):</strong> å­¸ç¿’æ¨¹ç‹€çµæ§‹çš„éæ­·ã€‚æ¯ä¸€æ­¥éƒ½é¢è‡¨å‘å·¦æˆ–å‘å³çš„é¸æ“‡ï¼ŒéŒ¯èª¤çš„æ±ºå®šå°‡å°è‡´å¢œè½ï¼Œæ­£ç¢ºçš„è·¯å¾‘å‰‡æ§‹æˆä¸€æ£µäºŒå…ƒæ¨¹ã€‚</div></a>
                <a class="island" data-game="graph-game.html"><div class="island-icon">ğŸ—ºï¸</div><div class="island-name">æœ€çŸ­è·¯å¾‘æŒ‘æˆ°</div><div class="island-description"><strong>Graph (åœ–):</strong> å­¸ç¿’åœ–çš„éæ­·èˆ‡æœ€çŸ­è·¯å¾‘æ¼”ç®—æ³•ã€‚åœ¨çœ‹ä¼¼è¤‡é›œçš„åœ°åœ–ä¸­ï¼Œé‹ç”¨æ¼”ç®—æ³•æ€ç¶­æ‰¾å‡ºå¾èµ·é»åˆ°çµ‚é»çš„æœ€ä½³è·¯ç·šã€‚</div></a>
                <a class="island" data-game="sorting-game.html"><div class="island-icon">ğŸ¯</div><div class="island-name">å½ˆç æ’åºæŒ‘æˆ°</div><div class="island-description"><strong>Sorting (æ’åº):</strong> è¦ªæ‰‹æ“ä½œç¶“å…¸çš„ã€Œæ°£æ³¡æ’åºæ³•ã€ï¼Œå°‡æ··äº‚çš„å½ˆç æŒ‰ç…§å¤§å°é †åºæ’åˆ—æ•´é½Šï¼Œç›´è§€åœ°ç†è§£æ’åºæ¼”ç®—æ³•çš„é‹ä½œéç¨‹ã€‚</div></a>
            </div>
        </div>
    </section>

    <section class="articles-section">
        <h2 class="section-title">ğŸ“š å­¸ç¿’è³‡æº</h2>
        <div class="articles-grid">
            <div class="article-card" onclick="location.href='article-algorithm-intro.html';"><div class="article-icon">ğŸ’¡</div><h3 class="article-title">æ¼”ç®—æ³•æ¦‚è«–ï¼šç¨‹å¼è¨­è¨ˆçš„éˆé­‚</h3><p class="article-subtitle">å¾æ¦‚å¿µåˆ°æ‡‰ç”¨</p><p class="article-description">æ·±å…¥æ·ºå‡ºåœ°è§£é‡‹æ¼”ç®—æ³•çš„å®šç¾©ã€é‡è¦æ€§ï¼Œä»¥åŠå®ƒå¦‚ä½•é©…å‹•ç¾ä»£ç§‘æŠ€ã€‚</p></div>
            <div class="article-card" onclick="location.href='article-data-structure-overview.html';"><div class="article-icon">ğŸ§±</div><h3 class="article-title">è³‡æ–™çµæ§‹ç¸½è¦½ï¼šé«˜æ•ˆçµ„ç¹”æ•¸æ“šçš„è—è¡“</h3><p class="article-subtitle">é™£åˆ—ã€éˆçµä¸²åˆ—ã€æ¨¹èˆ‡åœ–</p><p class="article-description">æ¢ç´¢å„ç¨®è³‡æ–™çµæ§‹çš„ç‰¹æ€§èˆ‡æ‡‰ç”¨å ´æ™¯ï¼Œäº†è§£å¦‚ä½•é¸æ“‡æœ€é©åˆçš„å·¥å…·ã€‚</p></div>
            <div class="article-card" onclick="location.href='article-queue-stack.html';"><div class="article-icon">ğŸ”„</div><h3 class="article-title">ä½‡åˆ—èˆ‡å †ç–Šï¼šå…ˆé€²å…ˆå‡ºèˆ‡å¾Œé€²å…ˆå‡º</h3><p class="article-subtitle">å…©ç¨®åŸºæœ¬æ•¸æ“šçµæ§‹çš„æ‡‰ç”¨</p><p class="article-description">é€éç”Ÿæ´»å¯¦ä¾‹ï¼Œç†è§£ä½‡åˆ— (Queue) å’Œå †ç–Š (Stack) çš„é‹ä½œåŸç†åŠå…¶åœ¨ç¨‹å¼ä¸­çš„æ‡‰ç”¨ã€‚</p></div>
            <div class="article-card" onclick="location.href='article-linked-list.html';"><div class="article-icon">ğŸ”—</div><h3 class="article-title">éˆçµä¸²åˆ—ï¼šå½ˆæ€§æ•¸æ“šçµ„ç¹”çš„åŸºçŸ³</h3><p class="article-subtitle">å‹•æ…‹è¨˜æ†¶é«”ç®¡ç†çš„ç§˜å¯†</p><p class="article-description">å­¸ç¿’éˆçµä¸²åˆ—çš„ç¯€é»é€£çµæ–¹å¼ï¼Œä»¥åŠå®ƒåœ¨å‹•æ…‹æ•¸æ“šè™•ç†ä¸Šçš„å„ªå‹¢ã€‚</p></div>
            <div class="article-card" onclick="location.href='article-tree-binary-tree.html';"><div class="article-icon">ğŸŒ³</div><h3 class="article-title">æ¨¹ç‹€çµæ§‹èˆ‡äºŒå…ƒæ¨¹ï¼šéšå±¤æ•¸æ“šçš„å®Œç¾å‘ˆç¾</h3><p class="article-subtitle">å¾å®¶è­œåˆ°æœå°‹å¼•æ“</p><p class="article-description">æ¢ç´¢æ¨¹çš„å„ç¨®å½¢æ…‹ï¼Œç‰¹åˆ¥æ˜¯äºŒå…ƒæ¨¹çš„æœå°‹ã€æ’å…¥èˆ‡åˆªé™¤æ“ä½œã€‚</p></div>
            <div class="article-card" onclick="location.href='article-graph-dijkstra.html';"><div class="article-icon">ğŸŒ</div><h3 class="article-title">åœ–è«–èˆ‡æœ€çŸ­è·¯å¾‘ï¼šè¤‡é›œç¶²çµ¡çš„å°èˆªè€…</h3><p class="article-subtitle">Dijkstra æ¼”ç®—æ³•çš„æ‡‰ç”¨</p><p class="article-description">ç†è§£åœ–çš„æ§‹æˆï¼Œä»¥åŠ Dijkstra æ¼”ç®—æ³•å¦‚ä½•åœ¨é«˜éµè·¯ç·šã€ç¶²è·¯è·¯ç”±ä¸­æ‰¾åˆ°æœ€ä½³è·¯å¾‘ã€‚</p></div>
        </div>
    </section>

    <script type="module">
        import { onAuthenticationChanged } from './firebase-auth.js';

        const animationModal = document.getElementById('animation-modal');
        const cardGroup = document.getElementById('card-group');
        const challengerArm = document.getElementById('challenger-arm');
        const closeBtn = document.getElementById('close-btn');

        // --- Story-driven Animation Logic ---
        const typingSpeed = 80;
        const line1 = document.getElementById('line1');
        const line2 = document.getElementById('line2');
        const cursor = document.getElementById('cursor');
        const textScene = document.getElementById('text-scene');
        const characterScene = document.getElementById('character-scene');

        function type(element, text, callback) {
            let i = 0;
            cursor.style.display = 'block';
            const cursorY = element.getAttribute('y') - 20;
            cursor.setAttribute('y', cursorY);

            function typing() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    cursor.setAttribute('x', 50 + (element.textContent.length * 14.5));
                    i++;
                    setTimeout(typing, typingSpeed);
                } else if (callback) {
                    cursor.style.display = 'none';
                    callback();
                }
            }
            typing();
        }

        function playAnimation() {
            animationModal.style.display = 'flex';
            setTimeout(() => {
                type(line1, 'ä½ å­å€¦äº†ç„¡æ­¢ç›¡çš„ Bug èˆ‡è¤‡é›œçš„é‚è¼¯å—ï¼Ÿ', () => {
                    setTimeout(() => {
                        type(line2, 'ä¸€å€‹èƒ½å°‡æŠ½è±¡æ¦‚å¿µåŒ–ç‚ºç”Ÿå­˜æŒ‘æˆ°çš„éŠæˆ²ã€‚', () => {
                            setTimeout(() => {
                                textScene.style.display = 'none';
                                characterScene.style.opacity = 1;
                            }, 1000);
                        });
                    }, 500);
                });
            }, 1000);
        }

        function closeAnimation() { animationModal.style.display = 'none'; }
        cardGroup.addEventListener('click', () => {
            challengerArm.style.animation = 'arm-slap 0.2s ease-in forwards';
            cardGroup.style.animation = 'card-flip-out 0.5s 0.1s ease-in-out forwards';
            setTimeout(closeAnimation, 800);
        });
        closeBtn.addEventListener('click', closeAnimation);
        
        if (!sessionStorage.getItem('hasVisited')) {
            window.addEventListener('load', playAnimation);
            sessionStorage.setItem('hasVisited', 'true');
        }

        // --- Page transition animation ---
        document.querySelectorAll('.island').forEach(island => {
            island.addEventListener('click', function(e) {
                if (this.classList.contains('disabled')) { e.preventDefault(); return; }
                e.preventDefault();
                const destination = this.dataset.game;
                document.body.style.transition = 'opacity 0.5s ease-out';
                document.body.style.opacity = '0';
                setTimeout(() => { window.location.href = destination; }, 500);
            });
        });

        // --- Auth Logic ---
        onAuthenticationChanged(user => {
            const islands = document.querySelectorAll('.island');
            if (user) {
                islands.forEach(island => island.classList.remove('disabled'));
            } else {
                islands.forEach(island => {
                    if (island.dataset.game === 'queue-game.html') {
                        island.classList.remove('disabled');
                        return;
                    }
                    island.classList.add('disabled');
                });
            }
        });
    </script>
    <script type="module" src="main-auth.js"></script>
</body>
</html>